<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/favicon.png">

    <title>@yield('title')</title>
    <meta name="description" content="@yield('description')">

    @vite('resources/css/app.css')

    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/sort@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body class="bg-gray-200 dark:bg-gray-700 dark:text-white min-h-screen flex flex-col gap-6">
    <header>
        <div class="container max-w-6xl mx-auto px-4 py-6">
            <div class="flex justify-between items-center flex-col sm:flex-row gap-8">
                <div class="flex gap-4 items-center">
                    <a href="{{ route('home') }}" class="text-2xl font-bold">
                        <svg fill="currentColor" viewBox="0 0 888 888" class="h-20">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M444 868.5C599.78 868.5 735.961 784.589 809.81 659.5H78.1899C152.039 784.589 288.22 868.5 444 868.5ZM447.762 19.5163L813.538 653.058C848.525 591.346 868.5 520.006 868.5 444C868.5 210.81 680.475 21.5366 447.762 19.5163ZM19.5 444C19.5 210.81 207.525 21.5366 440.238 19.5163L74.4624 653.058C39.4753 591.346 19.5 520.006 19.5 444ZM444 888C689.214 888 888 689.214 888 444C888 198.786 689.214 0 444 0C198.786 0 0 198.786 0 444C0 689.214 198.786 888 444 888ZM495.481 630.373V513.673L557.37 513.673V630.379H583.138L583.138 339.946L583.132 338.938C583.045 323.894 582.97 310.928 570.125 292.758C557.581 276.114 535.885 273.949 526.939 274.001C514.247 274.001 499.885 278.079 488.936 288.05C478.017 298.04 469.787 313.969 469.718 339.946L469.718 490.473L454 490.467V513.673L469.718 513.673V630.373H495.481ZM329.776 513.746V630.446H304.014V513.746L288.295 513.745V490.54L304.014 490.545L304.014 340.018C304.082 314.042 312.312 298.113 323.232 288.123C334.181 278.152 348.542 274.074 361.235 274.074C370.18 274.022 391.876 276.187 404.42 292.831C417.265 311.001 417.34 323.967 417.427 339.011L417.433 340.018L417.433 630.451H391.665V513.746H329.776ZM557.477 483.697V340.027C557.472 339.571 557.469 339.099 557.466 338.613C557.43 332.48 557.38 324.031 553.881 315.966C551.979 311.636 548.832 307.374 544.148 304.401C539.473 301.41 533.528 299.837 526.536 299.848C519.515 299.837 513.545 301.452 508.87 304.505C501.793 309.109 498.501 316.309 497.041 322.761C495.619 328.978 495.605 334.993 495.595 339.395C495.595 339.61 495.594 339.82 495.594 340.027V490.554H557.477V483.697ZM391.883 340.027V483.697V490.554H330V340.027C330.001 339.82 330.001 339.61 330.002 339.395C330.012 334.993 330.025 328.978 331.447 322.761C332.908 316.309 336.2 309.109 343.276 304.505C347.952 301.452 353.921 299.837 360.943 299.848C367.935 299.837 373.879 301.41 378.555 304.401C383.239 307.374 386.385 311.636 388.287 315.966C391.786 324.031 391.837 332.479 391.873 338.613C391.876 339.099 391.879 339.571 391.883 340.027Z" />
                            <path
                                d="M238.843 728V672.727H260.65C264.824 672.727 268.387 673.474 271.337 674.967C274.306 676.443 276.564 678.539 278.112 681.256C279.677 683.955 280.46 687.13 280.46 690.783C280.46 694.453 279.668 697.611 278.085 700.256C276.501 702.883 274.207 704.898 271.202 706.301C268.216 707.705 264.599 708.406 260.353 708.406H245.752V699.014H258.464C260.695 699.014 262.548 698.708 264.023 698.097C265.499 697.485 266.596 696.567 267.316 695.344C268.054 694.12 268.423 692.6 268.423 690.783C268.423 688.947 268.054 687.4 267.316 686.141C266.596 684.881 265.49 683.928 263.996 683.28C262.521 682.614 260.659 682.281 258.41 682.281H250.529V728H238.843ZM268.692 702.847L282.43 728H269.529L256.089 702.847H268.692ZM288.718 728V672.727H325.962V682.362H300.404V695.533H324.046V705.168H300.404V718.365H326.07V728H288.718ZM384.022 692.078H372.201C371.985 690.549 371.544 689.19 370.878 688.003C370.212 686.797 369.358 685.772 368.314 684.926C367.271 684.08 366.065 683.433 364.698 682.983C363.348 682.533 361.882 682.308 360.299 682.308C357.438 682.308 354.946 683.019 352.823 684.44C350.7 685.844 349.053 687.895 347.884 690.594C346.714 693.275 346.13 696.531 346.13 700.364C346.13 704.304 346.714 707.615 347.884 710.295C349.071 712.976 350.727 715 352.85 716.368C354.973 717.735 357.429 718.419 360.218 718.419C361.783 718.419 363.231 718.212 364.563 717.798C365.912 717.384 367.109 716.782 368.152 715.99C369.196 715.18 370.06 714.2 370.743 713.048C371.445 711.897 371.931 710.583 372.201 709.108L384.022 709.162C383.716 711.699 382.951 714.146 381.728 716.503C380.522 718.842 378.894 720.938 376.843 722.791C374.81 724.626 372.381 726.084 369.556 727.163C366.749 728.225 363.573 728.756 360.029 728.756C355.099 728.756 350.691 727.64 346.804 725.409C342.936 723.178 339.877 719.948 337.628 715.72C335.397 711.492 334.282 706.373 334.282 700.364C334.282 694.336 335.415 689.208 337.682 684.98C339.949 680.752 343.026 677.531 346.912 675.318C350.799 673.087 355.171 671.972 360.029 671.972C363.231 671.972 366.2 672.421 368.935 673.321C371.688 674.221 374.126 675.534 376.249 677.261C378.372 678.971 380.099 681.067 381.431 683.55C382.78 686.033 383.644 688.875 384.022 692.078ZM443.194 700.364C443.194 706.391 442.052 711.519 439.767 715.747C437.5 719.975 434.405 723.205 430.483 725.436C426.578 727.649 422.188 728.756 417.312 728.756C412.4 728.756 407.992 727.64 404.088 725.409C400.183 723.178 397.098 719.948 394.831 715.72C392.564 711.492 391.43 706.373 391.43 700.364C391.43 694.336 392.564 689.208 394.831 684.98C397.098 680.752 400.183 677.531 404.088 675.318C407.992 673.087 412.4 671.972 417.312 671.972C422.188 671.972 426.578 673.087 430.483 675.318C434.405 677.531 437.5 680.752 439.767 684.98C442.052 689.208 443.194 694.336 443.194 700.364ZM431.346 700.364C431.346 696.459 430.761 693.167 429.592 690.486C428.44 687.805 426.812 685.772 424.707 684.386C422.602 683.001 420.137 682.308 417.312 682.308C414.487 682.308 412.022 683.001 409.917 684.386C407.812 685.772 406.175 687.805 405.005 690.486C403.854 693.167 403.278 696.459 403.278 700.364C403.278 704.268 403.854 707.561 405.005 710.241C406.175 712.922 407.812 714.955 409.917 716.341C412.022 717.726 414.487 718.419 417.312 718.419C420.137 718.419 422.602 717.726 424.707 716.341C426.812 714.955 428.44 712.922 429.592 710.241C430.761 707.561 431.346 704.268 431.346 700.364ZM458.719 672.727L472.079 714.722H472.592L485.978 672.727H498.933L479.879 728H464.819L445.738 672.727H458.719ZM505.585 728V672.727H542.83V682.362H517.271V695.533H540.913V705.168H517.271V718.365H542.938V728H505.585ZM552.12 728V672.727H573.927C578.101 672.727 581.664 673.474 584.615 674.967C587.583 676.443 589.842 678.539 591.389 681.256C592.954 683.955 593.737 687.13 593.737 690.783C593.737 694.453 592.945 697.611 591.362 700.256C589.779 702.883 587.484 704.898 584.48 706.301C581.493 707.705 577.877 708.406 573.63 708.406H559.029V699.014H571.741C573.972 699.014 575.825 698.708 577.301 698.097C578.776 697.485 579.874 696.567 580.593 695.344C581.331 694.12 581.7 692.6 581.7 690.783C581.7 688.947 581.331 687.4 580.593 686.141C579.874 684.881 578.767 683.928 577.274 683.28C575.798 682.614 573.936 682.281 571.687 682.281H563.806V728H552.12ZM581.97 702.847L595.707 728H582.806L569.366 702.847H581.97ZM596.456 672.727H609.545L622.149 696.531H622.689L635.293 672.727H648.382L628.222 708.46V728H616.616V708.46L596.456 672.727Z" />
                            <path
                                d="M615.193 202.629C616.97 201.353 617.972 199.705 618.197 197.684C618.422 195.664 617.833 193.438 616.43 191.007C615.476 189.356 614.438 188.096 613.313 187.228C612.205 186.352 611.07 185.844 609.909 185.704C608.757 185.579 607.666 185.814 606.638 186.408C605.763 186.871 605.119 187.482 604.705 188.241C604.3 189.015 604.066 189.887 604.003 190.858C603.956 191.82 604.027 192.86 604.215 193.977C604.418 195.086 604.704 196.229 605.073 197.408L606.528 202.303C607.266 204.66 607.749 206.937 607.978 209.132C608.206 211.327 608.121 213.391 607.721 215.326C607.321 217.26 606.552 219.023 605.414 220.615C604.286 222.223 602.729 223.61 600.743 224.777C597.805 226.453 594.833 227.171 591.828 226.932C588.848 226.7 585.965 225.539 583.179 223.449C580.418 221.366 577.913 218.377 575.664 214.481C573.433 210.617 572.082 206.909 571.611 203.358C571.149 199.823 571.615 196.583 573.01 193.638C574.43 190.699 576.839 188.196 580.238 186.13L585.892 195.924C584.35 196.959 583.275 198.193 582.668 199.624C582.085 201.061 581.917 202.623 582.163 204.309C582.434 206.002 583.073 207.721 584.081 209.466C585.071 211.18 586.179 212.524 587.406 213.498C588.643 214.488 589.907 215.077 591.2 215.266C592.493 215.454 593.716 215.215 594.869 214.55C595.945 213.929 596.664 213.088 597.027 212.026C597.4 210.98 597.492 209.701 597.305 208.188C597.126 206.692 596.744 204.949 596.157 202.961L594.457 196.993C593.108 192.391 592.803 188.318 593.542 184.776C594.28 181.233 596.423 178.448 599.969 176.422C602.858 174.733 605.835 174.042 608.901 174.35C611.975 174.673 614.912 175.855 617.711 177.896C620.509 179.937 622.916 182.702 624.931 186.192C626.983 189.745 628.165 193.197 628.479 196.547C628.802 199.914 628.308 202.962 626.997 205.693C625.685 208.424 623.618 210.636 620.793 212.329L615.193 202.629ZM591 239.479L638.868 211.842L657.49 244.097L649.146 248.914L636.367 226.78L624.961 233.365L636.782 253.84L628.438 258.657L616.617 238.183L605.187 244.782L618.02 267.009L609.676 271.827L591 239.479ZM614.268 279.779L662.135 252.143L673.039 271.028C675.126 274.643 676.26 278.102 676.443 281.404C676.649 284.712 675.963 287.716 674.384 290.415C672.829 293.12 670.47 295.385 667.307 297.211C664.128 299.047 660.998 299.94 657.916 299.891C654.849 299.833 651.957 298.854 649.239 296.954C646.53 295.069 644.115 292.288 641.991 288.61L634.691 275.966L642.825 271.27L649.181 282.278C650.296 284.21 651.488 285.662 652.755 286.634C654.023 287.606 655.366 288.098 656.785 288.109C658.214 288.137 659.715 287.696 661.289 286.787C662.878 285.87 664.034 284.776 664.756 283.508C665.486 282.255 665.759 280.82 665.573 279.203C665.412 277.592 664.769 275.813 663.645 273.865L659.704 267.04L620.111 289.9L614.268 279.779ZM650.976 293.053L636.061 317.526L629.611 306.354L644.674 282.138L650.976 293.053ZM691.324 302.698L661.635 335.265L661.891 335.709L704.953 326.305L711.43 337.524L654.036 348.659L646.506 335.617L684.833 291.456L691.324 302.698ZM720.599 353.406L672.732 381.042L666.889 370.922L714.756 343.285L720.599 353.406ZM733.033 413.642L727.122 403.405C728.339 402.453 729.295 401.392 729.99 400.222C730.701 399.043 731.162 397.79 731.373 396.463C731.583 395.137 731.542 393.769 731.247 392.36C730.962 390.966 730.424 389.584 729.632 388.213C728.202 385.735 726.34 383.932 724.048 382.805C721.771 381.668 719.171 381.267 716.249 381.604C713.343 381.932 710.23 383.053 706.911 384.97C703.499 386.94 700.924 389.102 699.187 391.455C697.459 393.824 696.534 396.269 696.411 398.792C696.289 401.314 696.924 403.783 698.319 406.198C699.102 407.554 700.005 408.705 701.029 409.651C702.062 410.612 703.182 411.347 704.39 411.855C705.613 412.354 706.894 412.612 708.233 412.628C709.581 412.66 710.961 412.424 712.374 411.92L718.238 422.184C715.888 423.188 713.386 423.749 710.733 423.868C708.105 423.994 705.475 423.631 702.845 422.782C700.239 421.939 697.762 420.564 695.415 418.657C693.092 416.757 691.045 414.272 689.273 411.203C686.808 406.933 685.57 402.558 685.559 398.077C685.557 393.611 686.824 389.347 689.361 385.286C691.908 381.239 695.783 377.714 700.987 374.709C706.207 371.695 711.215 370.113 716.01 369.962C720.805 369.811 725.133 370.866 728.993 373.125C732.868 375.375 736.02 378.604 738.449 382.811C740.05 385.584 741.145 388.38 741.734 391.198C742.331 394.032 742.412 396.8 741.978 399.503C741.559 402.196 740.608 404.74 739.123 407.134C737.648 409.545 735.617 411.714 733.033 413.642ZM706.113 438.861L753.981 411.224L772.603 443.479L764.259 448.296L751.48 426.162L740.074 432.747L751.895 453.222L743.551 458.039L731.73 437.565L720.301 444.164L733.134 466.391L724.79 471.209L706.113 438.861Z" />
                            <path
                                d="M155.824 374.385L161.667 364.265L192.753 382.212C196.244 384.227 198.816 386.824 200.472 390.003C202.136 393.166 202.841 396.658 202.587 400.48C202.318 404.293 201.041 408.178 198.756 412.136C196.462 416.109 193.731 419.166 190.564 421.305C187.381 423.436 184.004 424.571 180.433 424.711C176.861 424.852 173.33 423.914 169.84 421.899L138.754 403.952L144.597 393.831L174.818 411.279C176.641 412.332 178.491 412.87 180.368 412.894C182.254 412.903 184.025 412.408 185.68 411.411C187.336 410.414 188.727 408.942 189.851 406.994C190.985 405.031 191.565 403.091 191.591 401.174C191.626 399.242 191.164 397.469 190.205 395.855C189.255 394.226 187.869 392.886 186.045 391.833L155.824 374.385ZM189.591 315.9L237.458 343.537L232.411 352.278L190.26 355.709L190.058 356.06L220.185 373.454L214.342 383.574L166.475 355.938L171.603 347.056L213.636 343.775L213.879 343.355L183.774 325.974L189.591 315.9ZM200.261 297.418L248.129 325.055L242.286 335.175L194.418 307.539L200.261 297.418ZM212.36 295.732L204.016 290.915L226.713 251.602L235.058 256.419L226.597 271.074L266.12 293.893L260.344 303.896L220.821 281.077L212.36 295.732ZM228.832 247.932L235.377 236.596L262.293 237.583L262.563 237.116L248.25 214.298L254.795 202.963L275.66 238.289L292.582 248.059L286.78 258.109L269.858 248.339L228.832 247.932Z" />
                        </svg>
                    </a>
                    <a href="/" class="text-2xl font-light">
                        <h1>{{ __('General Service App') }}</h1>
                    </a>
                </div>
                <div>
                    @auth
                        <div x-data="{ isOpen: false }" class="relative">
                            @include('common.button', [
                                'click' => 'isOpen = !isOpen',
                                'icon' => 'chevron-down',
                                'highlighted' => 'isOpen',
                            ])

                            <div x-show="isOpen" x-cloak x-transition:enter="transition ease-out duration-100 transform"
                                x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100"
                                x-transition:leave="transition ease-in duration-75 transform"
                                x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95"
                                class="-ml-28 left-[50%] md:left-auto md:origin-top-right absolute md:right-0 mt-2 w-56 rounded-md shadow-lg">
                                <div class="rounded bg-white text-black shadow-xs">
                                    @foreach (auth()->user()->entities as $entity)
                                        <a href="{{ route('entities.stories.index', $entity) }}"
                                            class="flex p-3 border-b gap-2 align-center">
                                            @include ('common.icon', ['icon' => 'home'])
                                            {{ $entity->name() }}
                                        </a>
                                    @endforeach
                                    @if (auth()->user()->admin)
                                        <a href="{{ route('entities.index') }}"
                                            class="flex p-3 border-b gap-2 align-center">
                                            @include ('common.icon', ['icon' => 'cog'])
                                            {{ __('Entities') }}
                                        </a>
                                        <a href="{{ route('users.index') }}" class="flex p-3 border-b gap-2 align-center">
                                            @include ('common.icon', ['icon' => 'cog'])
                                            {{ __('Users') }}
                                        </a>
                                    @endif
                                    <a href="/logout" class="flex p-3 border-b gap-2 align-center">
                                        @include ('common.icon', ['icon' => 'x'])
                                        {{ __('Log Out') }}
                                    </a>
                                </div>
                            </div>
                        </div>
                    @endauth

                    @guest
                        @if (!Request::is('login'))
                            @include('common.button', ['href' => route('login'), 'label' => __('Log in')])
                        @endif
                    @endguest
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow @yield('main-class')">

        @yield('content')

    </main>

    <footer class="pb-8 text-center text-sm">
        <p>
            <a href="{{ route('privacy') }}" class="text-black/70 dark:text-white/70 hover:underline">
                {{ __('Privacy Policy') }}
            </a>
        </p>
    </footer>
</body>

</html>
